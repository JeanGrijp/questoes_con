# 3.1.1. Requisitos funcionais e não funcionais

Este tópico trata da captura, escrita e gestão de requisitos. O objetivo é descrever claramente o que o sistema deve fazer (funcionais) e como deve se comportar em termos de qualidade e restrições (não funcionais), de forma testável e alinhada ao negócio.

## Conceitos essenciais

Requisitos funcionais descrevem comportamentos observáveis: operações, regras de negócio, fluxos e integrações. Requisitos não funcionais (atributos de qualidade) definem critérios como desempenho, segurança, disponibilidade, usabilidade, manutenibilidade e conformidade. Ambos devem ser verificáveis e rastreáveis a objetivos de negócio.

Uma boa prática é decompor objetivos em histórias de usuário, casos de uso ou especificações de cenários, sempre com critérios de aceitação claros. Prefira linguagem simples, sem ambiguidade, e evite soluções técnicas prematuras quando ainda se está descobrindo o problema.

Explicação:

- Requisito funcional (RF) foca no comportamento visível ao usuário ou a sistemas externos (o que o sistema faz). Ex.: “Permitir cadastro de usuário com e-mail de confirmação.”
- Requisito não funcional (RNF) foca em qualidade/restrição (como o sistema deve se comportar). Ex.: “Responder 95% das requisições de cadastro em ≤ 800 ms.”
- Ambos devem ser verificáveis. Se não é possível medir/testar, reescreva até ficar objetivo.

## Como escrever bons requisitos

- Use linguagem específica e verificável: evitar termos vagos como “rápido”, “intuitivo” e “robusto” sem métricas.
- Vincule cada requisito a uma fonte (stakeholder, regulatório) e a uma justificativa de negócio.
- Adote critérios de aceitação objetivos; em histórias, use o padrão Dado/Quando/Então.
- Diferencie “o que” (requisito) de “como” (solução), exceto quando a tecnologia for uma restrição do escopo.
- Mantenha rastreabilidade: requisito → item de backlog → PR/commit → evidência de teste.

Exemplo (ruim → bom):

- Ruim: “O relatório deve ser rápido.”
- Bom: “O endpoint GET /relatorios/{id} deve responder 95% das requisições em até 800 ms sob carga de 50 req/s, medido em produção durante horário comercial.”

## Modelos e técnicas

- Histórias de usuário (INVEST): independentes, negociáveis, valiosas, estimáveis, pequenas e testáveis.
- Casos de uso: úteis para fluxos complexos com múltiplos cenários de sucesso e exceção.
- Requisitos não funcionais: expresse como SLAs/SLIs/SLOs quando aplicável.
- Elicitação: entrevistas, workshops, observação, prototipação, análise de processos e documentos.

Como aplicar:

- Histórias de usuário são adequadas a descoberta e colaboração. Casos de uso ajudam a detalhar fluxos complexos e exceções. Para RNFs, prefira metas mensuráveis (SLO) e critérios de aceitação específicos.
- Combine elicitação (entrevista/observação) com protótipos para reduzir ambiguidade cedo. Documentos existentes e processos atuais são fontes valiosas de regras.

## SLIs, SLOs e SLAs (conceitos de prova)

- SLI (Service Level Indicator): indicador medido (ex.: p95 latência, taxa de erros 5xx).
- SLO (Service Level Objective): meta interna para o SLI (ex.: p95 ≤ 800 ms/mês).
- SLA (Service Level Agreement): compromisso externo/contratual (ex.: 99,9% de uptime, crédito se violado).
- Orçamento de erro: 1 − SLO de disponibilidade (ex.: SLO 99,5% → 0,5% de indisponibilidade/mês ≈ 3h39min).

Por que importa:

- SLI é o que você mede; SLO é a meta interna; SLA é o compromisso externo. Provas cobram diferenças e exemplos. p95/p99 representam caudas de latência (melhor que média). “Orçamento de erro” define quanto você pode falhar sem romper o SLO.

## Priorização de requisitos

- MoSCoW: Must/Should/Could/Won’t (neste release).
- Kano: básicos (must-be), desempenho (linear), encantadores (delighters).
- WSJF (Scaled Agile): WSJF = (Valor + Urgência + Redução de Risco/Oportunidade) / Tamanho.
- Custo de atraso: priorize itens com maior custo por tempo de espera.

Quando usar cada um:

- MoSCoW é simples para governança de escopo; Kano auxilia descobrir valor percebido; WSJF maximiza valor por tempo (útil em filas grandes). Sempre evidencie a razão da prioridade (custo de atraso, risco, valor regulatório).

## Rastreabilidade e controle de mudanças

- Identificação única: RF-001, RNF-005, REG-003.
- Matriz de rastreabilidade: Requisito ↔ História ↔ Teste ↔ Código ↔ Evidência.
- Baseline: conjunto de requisitos aprovado; mudanças passam por controle (impacto, aprovação, versão).
- Critérios DOR/DOD: pronto para desenvolvimento e pronto para aceite.

Entenda os termos:

- Baseline é o “congelamento” de requisitos aprovados. Mudanças passam por análise de impacto e versionamento.
- DOR (Definition of Ready) garante que um item pode entrar em desenvolvimento; DOD (Definition of Done) define o que é necessário para aceitar/fechar (teste, documentação, evidência).

## Requisitos de integração e APIs

- Contratos: especificação (OpenAPI), versionamento (v1, v2), depreciação planejada.
- Idempotência em operações não seguras; correção de códigos HTTP; paginação e limites.
- SLIs de integração: timeouts, retries exponenciais, circuit breaker, DLQ para eventos.
- Segurança: OAuth2/OIDC, escopos mínimos, proteção contra rate limit abuse.

Explicação:

- Versionamento evita quebra de consumidores; comunique depreciações e ofereça período de transição.
- Idempotência garante que repetição não cause efeitos colaterais além do primeiro sucesso (ex.: POST com chave de idempotência).
- Resiliência (timeouts/retries/circuit breaker) é RNF crítico para integrações e deve virar critérios de aceitação/teste.

## Requisitos de dados e compliance

- LGPD: base legal, finalidade, minimização, retenção, consentimento, anonimização/pseudonimização.
- Qualidade de dados: unicidade, integridade referencial, validações de campo, trilhas de auditoria.
- Retenção e descarte: políticas por tipo de dado; exportabilidade e portabilidade quando aplicável.

Como cai na LGPD:

- Transforme princípios em requisitos verificáveis: “Registrar base legal por finalidade”; “Permitir exclusão (‘apagar’) em até 30 dias”; “Minimizar coleta a campos necessários”. Gere evidências (auditoria) para comprovar conformidade.

## Segurança (exemplos de RNFs)

- Autenticação: MFA para perfis sensíveis; expiração de sessão em 15 min de inatividade.
- Autorização: RBAC/ABAC; privilégio mínimo; segregação de funções.
- Criptografia: TLS 1.2+; HSTS; sigilo perfeito; armazenamento com chaves gerenciadas (KMS).
- Proteções: validação de entrada; CSP; proteção CSRF; hashing de senhas com bcrypt/argon2.
- Auditoria e logging de segurança: eventos críticos imutáveis, carimbo de tempo, usuário, IP.

Contexto de prova:

- Diferencie RF de segurança (ex.: “Usuário deve redefinir senha via token”) de RNF de segurança (ex.: “Token expira em 15 min; hashing com Argon2id”). Cite OWASP ASVS como referência de requisitos de controle por nível.

## Desempenho, disponibilidade e confiabilidade

- Metas de latência p95/p99 por endpoint; orçamentos de CPU/RAM; limites de fila.
- Disponibilidade por componente; replicação; recuperação de desastres (RPO/RTO).
- Testes: carga, estresse, volume, soak; caos/chaos engineering controlado.

Explicação:

- p95/p99 evitam mascarar picos; defina perfis de carga realistas. RTO (tempo para recuperar) e RPO (perda de dados aceitável) orientam DR. Disponibilidade composta não é soma simples; identifique SPOFs e estratégia de redundância.

## Usabilidade e acessibilidade

- Heurísticas de Nielsen; consistência de padrões; feedback imediato de ações.
- Acessibilidade: WCAG 2.1 AA (teclado, contraste, alternativas textuais, foco visível, ARIA adequada).
- Internacionalização/localização quando aplicável.

Explicação prática:

- SUS (System Usability Scale) dá nota comparável; WCAG 2.1 AA é o alvo comum em governo. Requisitos devem virar critérios testáveis (ex.: “Todo fluxo é navegável por teclado; contraste ≥ 4,5:1; foco visível em todos os elementos interativos”).

## Observabilidade e operação

- Logs estruturados (correlação de requisições), níveis e retenção definidos.
- Métricas de aplicação e infraestrutura; alertas baseados em SLOs; dashboards por domínio.
- Rastreamento distribuído (trace/span) para fluxos interserviços.

Por que colocar como requisito:

- Sem logs estruturados e correlação (traceId), incidentes ficam “invisíveis”. Defina métricas-chave e alertas orientados a SLO para evitar fadiga de alerta. Inclua requisitos de retenção e proteção de logs (compliance).

## Exemplos práticos (RF e RNF)

- RF-001: O sistema deve permitir ao usuário gerar segunda via de boleto a partir do CPF e número de contrato válidos.
- RF-002: O sistema deve enviar e-mail de confirmação após atualização de senha.
- RNF-Desempenho-005: p95 de POST /boletos em ≤ 1200 ms sob 100 req/s.
- RNF-Segurança-010: Dados pessoais sensíveis devem ser criptografados em repouso com AES-256 e chave rotacionada a cada 90 dias.
- RNF-Disponibilidade-015: Disponibilidade mensal do módulo de pagamentos ≥ 99,7%; RTO ≤ 1h; RPO ≤ 15 min.
- RNF-Acessibilidade-020: Páginas públicas devem atingir WCAG 2.1 nível AA.

Notas rápidas:

- Sempre associe RF a um resultado observável do usuário/negócio e RNF a uma meta mensurável. Releia exemplos substituindo termos vagos por métricas ou condições claras de sucesso.

## O que mais cai em prova (resumo rápido)

- Diferença entre requisito funcional e não funcional com exemplos.
- ISO/IEC 25010: categorias e exemplos de métricas.
- IEEE 29148: conteúdo mínimo de especificação de requisitos.
- SLI × SLO × SLA e orçamento de erro.
- Modelos: história de usuário vs. caso de uso; critérios INVEST; Gherkin (Dado/Quando/Então).
- Priorização (MoSCoW, Kano, WSJF) e rastreabilidade.
- LGPD, segurança (OWASP), acessibilidade (WCAG).

## Pegadinhas de prova e como evitar

- “Disponibilidade 100%”: irreal no longo prazo; prefira SLO + orçamento de erro e janela de apuração.
- “Sistema seguro”: sem controles específicos não é verificável. Exija requisitos de controle (MFA, TLS, RBAC, logs de auditoria).
- “Compatível com todos os navegadores”: delimite escopo (versões/suporte).
- “Alta performance”: sem carga/perfil fica vazio. Traga perfil de uso, p95 e limites.
- “Conforme LGPD”: peça requisitos operacionais (base legal, registro de consentimento, anonimização, descarte).
